"use strict";(self.webpackChunkbmg_web_app=self.webpackChunkbmg_web_app||[]).push([[326],{7562:function(e,t,n){var r=n(1413),a=n(2791),o=n(6871),i=n(374),l=n(184);t.Z=function(e,t){return function(n){var s=(0,a.useContext)(i.V),c=(0,o.s0)(),d=s.userToken;return(0,a.useEffect)((function(){"undefined"!==typeof window&&(d?-1===(null===t||void 0===t?void 0:t.indexOf(s.userRole))&&c("/403",{replace:!0}):c("/auth",{replace:!0}))}),[d,s.userRole,c]),"undefined"!==typeof window?s.isLoading?(console.log("loading from with auth"),null):(0,l.jsx)(e,(0,r.Z)({},n)):null}}},342:function(e,t,n){n.r(t);var r=n(5861),a=n(1413),o=n(9439),i=n(7757),l=n.n(i),s=n(2791),c=n(8735),d=n(5303),u=n(7528),p=n(6755),m=n(3099),h=n(7496),x=n(3695),f=n(8164),g=n(4980),j=n(1333),y=n(7309),b=n(5696),Z=n(2567),v=n(7562),w=n(6208),D=n(374),k=n(3853),C=n(2426),S=n.n(C),_=n(4971),I=n(2393),O=n(7425),T=n(9353),E=n.n(T),M=n(8206),Y=n(4569),P=n.n(Y),F=n(184),R=c.Z.Title,N=c.Z.Text,q=d.Z.Option,z=function(e){var t=e.label,n=e.children;return(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:"14px"},children:[(0,F.jsx)(N,{type:"secondary",children:t}),(0,F.jsx)(R,{level:5,style:{marginTop:"0px"},children:n})]})},L=function(e){var t=e.label,n=e.children;return(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,F.jsx)(N,{type:"secondary",children:t}),(0,F.jsx)(N,{type:"secondary",style:{marginTop:"0px",marginBottom:"14px"},children:n})]})},B=function(e){var t,n=e.label,r=e.status,a=e.children;return t=0===r?_.YS:1===r?_.nq:_.E7,(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:"14px"},children:[(0,F.jsx)(N,{type:"secondary",children:n}),(0,F.jsx)("div",{style:{flexDirection:"row"},children:(0,F.jsx)(u.Z,{color:t,children:a})})]})},G=function(e){var t=e.label,n=e.data;return(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:"14px"},children:[(0,F.jsx)(N,{type:"secondary",children:t}),(0,F.jsx)(p.Z.PreviewGroup,{children:(0,F.jsx)(m.Z,{wrap:!0,children:null===n||void 0===n?void 0:n.map((function(e){return(0,F.jsx)("div",{style:{width:120,height:70,overflow:"hidden"},children:(0,F.jsx)(p.Z,{src:e.image,width:120,alt:"image-reimbursement"})},e.image)}))})})]})},W=function(e){return S()(e).format("YYYY-MM-DD")};t.default=(0,v.Z)((function(){var e=(0,s.useContext)(D.V).signOut,t=(0,s.useContext)(D.V),n=(0,s.useState)({page:1,fromdate:W(t.firstDate),todate:W(t.lastDate),update:!1}),i=(0,o.Z)(n,2),c=i[0],d=i[1],p=(0,s.useState)(20),v=(0,o.Z)(p,2),C=v[0],T=v[1],Y=(0,s.useState)(""),K=(0,o.Z)(Y,2),Q=K[0],V=K[1],A=(0,w.cF)("reimburstment?emp_id=".concat(Q,"&from=").concat(c.fromdate,"&to=").concat(c.todate,"&page=").concat(c.page,"&perpage=").concat(C),c.update),U=A.data,H=A.pagination,J=A.loading,X=(0,w.KQ)("employee"),$=X.data,ee=X.loading,te=(0,s.useState)([W(t.firstDate),W(t.lastDate)]),ne=(0,o.Z)(te,2),re=ne[0],ae=ne[1],oe=(0,s.useState)(""),ie=(0,o.Z)(oe,2),le=ie[0],se=ie[1],ce=(0,s.useState)({}),de=(0,o.Z)(ce,2),ue=de[0],pe=de[1],me=(0,s.useState)(!1),he=(0,o.Z)(me,2),xe=he[0],fe=he[1],ge=h.Z.useForm(),je=(0,o.Z)(ge,1)[0],ye=(0,w.qY)(),be=ye.isOpen,Ze=ye.onOpen,ve=ye.onClose,we=(0,w.qY)(),De=we.isOpen,ke=we.onOpen,Ce=we.onClose;(0,s.useEffect)((function(){je.setFieldsValue({date:[S()(t.firstDate),S()(t.lastDate)]})}),[]);var Se=(0,s.useState)({url:"",data:{},trigger:0}),_e=(0,o.Z)(Se,2),Ie=_e[0],Oe=_e[1],Te=(0,w.Fc)(Ie.url,Ie.data,Ie.trigger),Ee=Te.onSuccess,Me=Te.loading,Ye=function(e){if(2===e&&!le)return x.ZP.warn("Form tidak boleh kosong!"),null;var t={status:e,reason:le};console.log("data post: ",t),Oe({url:"reimburstment/update?id=".concat(ue.id),data:t,trigger:Date.now()})};(0,s.useEffect)((function(){Ee&&(x.ZP.success("Proses approval berhasil"),Ce(),ve(),d((0,a.Z)((0,a.Z)({},c),{},{update:!c.update})))}),[Ee]);var Pe=function(){var n=(0,r.Z)(l().mark((function n(){var r,a;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return fe(!0),n.prev=1,n.next=4,P().get("".concat(M.F,"/api/reimburstment/export?emp_id=").concat(Q,"&from=").concat(c.fromdate,"&to=").concat(c.todate),{headers:{Authorization:"bearer ".concat(t.userToken)},responseType:"blob"});case 4:if(r=n.sent){n.next=7;break}throw new Error;case 7:x.ZP.success("Download in progress"),E()(r.data,"Reimbursement.xlsx"),console.log("fetch data /reimburstment/export?emp_id=".concat(Q,"&from=").concat(c.fromdate,"&to=").concat(c.todate)),fe(!1),n.next=26;break;case 13:if(n.prev=13,n.t0=n.catch(1),500!==(null===(a=n.t0.response)||void 0===a?void 0:a.status)){n.next=19;break}return x.ZP.error("".concat(n.t0.response.status,", ").concat(n.t0.response.statusText)),e(),n.abrupt("return",null);case 19:if(!n.t0.response){n.next=23;break}return x.ZP.error("".concat(n.t0.response.status,", ").concat(n.t0.response.statusText)),fe(!1),n.abrupt("return",null);case 23:x.ZP.error("Something went wrong, please try again.."),console.log(n.t0),fe(!1);case 26:case"end":return n.stop()}}),n,null,[[1,13]])})));return function(){return n.apply(this,arguments)}}(),Fe=[{title:"#",dataIndex:"document_no",render:function(e,t){return(0,F.jsx)(N,{strong:!0,style:{cursor:"pointer"},onClick:function(){pe(t),Ze()},children:e})},width:140},{title:"Title",dataIndex:"title",render:function(e,t){return(0,F.jsx)(N,{strong:!0,style:{cursor:"pointer"},onClick:function(){pe(t),Ze()},children:e})},ellipsis:!0},{title:"Note",dataIndex:"note",ellipsis:!0,responsive:["lg"]},{title:"Total",dataIndex:"total",align:"right",render:function(e){return(0,I.QD)(e)}},{title:"Status",dataIndex:"status_name",render:function(e,t){var n="";return n=0===t.status_id?_.YS:1===t.status_id?_.nq:_.E7,(0,F.jsx)(u.Z,{color:n,children:e})}},{title:"Employee",dataIndex:"employee"},{title:"Date",dataIndex:"date"}];return(0,F.jsxs)("div",{children:[(0,F.jsx)(f.Z,{style:{margin:"16px 0"},children:(0,F.jsx)(f.Z.Item,{children:"Reimbursement"})}),(0,F.jsxs)(g.Z,{title:"Details Reimbursement",visible:be,onCancel:ve,footer:!1,width:1e3,children:[(0,F.jsxs)(Z.Ej,{children:[(0,F.jsxs)(Z.b0,{children:[(0,F.jsx)(z,{label:"Document No",children:ue.document_no}),(0,F.jsx)(z,{label:"Title",children:ue.title}),"bbm_ops"===ue.title&&(0,F.jsx)(z,{label:"KM Mobil",children:ue.km_mobil}),"bbm_genset"===ue.title&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(z,{label:"Genset Meter Start",children:ue.genset_start}),(0,F.jsx)(z,{label:"Genset Meter End",children:ue.genset_end}),(0,F.jsx)(z,{label:"Genset Meter Total",children:ue.genset_total}),(0,F.jsx)(z,{label:"No Genset",children:ue.no_genset})]}),(0,F.jsx)(z,{label:"Date",children:ue.date})]}),(0,F.jsxs)(Z.b0,{children:[(0,F.jsx)(B,{label:"Status",status:ue.status_id,children:ue.status_name}),(0,F.jsx)(z,{label:"Employee",children:ue.employee}),(0,F.jsx)(L,{label:"Note",children:ue.note}),(0,F.jsx)(z,{label:"Total",children:ue.total})]})]}),(0,F.jsx)(G,{label:"Photos",data:ue.attachment}),0===ue.status_id&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(j.Z,{}),(0,F.jsx)(Z.Wy,{children:(0,F.jsxs)(m.Z,{children:[(0,F.jsx)(y.Z,{shape:"round",type:"primary",icon:(0,F.jsx)(k.UgA,{}),onClick:function(){return Ye(1)},children:"Approve"}),(0,F.jsx)(y.Z,{shape:"round",icon:(0,F.jsx)(k.q5L,{}),onClick:ke,children:"Disapprove"})]})})]})]}),(0,F.jsx)(g.Z,{title:"Remark Disapprove",visible:De,onCancel:Ce,footer:!1,children:(0,F.jsxs)(h.Z,{name:"remarkdisapprove",autoComplete:"off",children:[(0,F.jsx)(Z.ld,{label:"Remark Disapprove",requiredLabel:!0,name:"remark",required:!0,message:"please input remark disapprove!",rows:4,placeholder:"input remark disapprove",onChange:function(e){return(0,I.IY)(e,se)}}),(0,F.jsx)(Z.Wy,{children:(0,F.jsx)(h.Z.Item,{children:(0,F.jsx)(y.Z,{type:"primary",shape:"round",icon:(0,F.jsx)(k.t$,{}),onClick:function(){return Ye(2)},loading:Me,htmlType:"submit",children:"Submit"})})})]})}),(0,F.jsx)("div",{children:(0,F.jsxs)(Z.Zb,{children:[(0,F.jsx)(R,{level:4,type:"secondary",children:"Reimbursement"}),(0,F.jsxs)(Z.Ej,{children:[(0,F.jsx)(h.Z,{form:je,name:"form-reimbursement",autoComplete:"off",children:(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,F.jsx)(Z.gH,{name:"date",required:!0,message:"please select date",onChange:function(e,t){return ae(t)},format:"YYYY-MM-DD"}),(0,F.jsx)(h.Z.Item,{children:(0,F.jsx)(y.Z,{type:"primary",shape:"round",icon:(0,F.jsx)(k.Ihx,{style:{marginRight:"6px"}}),onClick:function(){if(0===re.length)return console.log("Form tidak bolah kosong"),null;d((0,a.Z)((0,a.Z)({},c),{},{page:1,fromdate:re[0],todate:re[1]}))},loading:J,htmlType:"submit",style:{marginLeft:16},children:"Show"})})]})}),(0,F.jsx)(Z.Wy,{style:{marginBottom:14},children:(0,F.jsx)(y.Z,{shape:"round",icon:(0,F.jsx)(O.WlY,{style:{marginRight:"6px"}}),onClick:Pe,loading:xe,children:"Export"})})]}),(0,F.jsx)("div",{style:{display:"flex",flexDirection:"row"},children:(0,F.jsx)(Z.ih,{name:"empId",placeholder:"filter employee",onChange:function(e){return V(e)},loading:ee,disabled:ee,style:{minWidth:290},children:$.map((function(e){return(0,F.jsx)(q,{value:e.id,children:"[".concat(e.id,"] ").concat(e.name)},e.id)}))})}),(0,F.jsx)(b.Z,{columns:Fe,dataSource:U,rowKey:function(e){return e.id},loading:J,scroll:{y:500},pagination:{total:H.total_data,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showQuickJumper:!0,defaultCurrent:1,onChange:function(e){return d((0,a.Z)((0,a.Z)({},c),{},{page:e}))},showSizeChanger:!0,onShowSizeChange:function(e,t){return T(t)},defaultPageSize:C,pageSizeOptions:[20,60,100,140]}})]})})]})}))},2393:function(e,t,n){n.d(t,{QD:function(){return a},cX:function(){return o},IY:function(){return i},U6:function(){return l}});n(2426);var r=n(5095),a=function(e){return new Intl.NumberFormat("id-ID").format(e)},o=function(e){return new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})},i=n.n(r)()((function(e,t){return t(e.target.value)}),500),l=function(e){return"number"===typeof e?e>=1e6?"".concat((e/1e6).toFixed(2)," MM"):e>=1e3?"".concat((e/1e3).toFixed(2)," KM"):"".concat(e," Meter"):e}},1333:function(e,t,n){var r=n(7462),a=n(4942),o=n(2791),i=n(1694),l=n.n(i),s=n(9077),c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};t.Z=function(e){return o.createElement(s.C,null,(function(t){var n,i=t.getPrefixCls,s=t.direction,d=e.prefixCls,u=e.type,p=void 0===u?"horizontal":u,m=e.orientation,h=void 0===m?"center":m,x=e.orientationMargin,f=e.className,g=e.children,j=e.dashed,y=e.plain,b=c(e,["prefixCls","type","orientation","orientationMargin","className","children","dashed","plain"]),Z=i("divider",d),v=h.length>0?"-".concat(h):h,w=!!g,D="left"===h&&null!=x,k="right"===h&&null!=x,C=l()(Z,"".concat(Z,"-").concat(p),(n={},(0,a.Z)(n,"".concat(Z,"-with-text"),w),(0,a.Z)(n,"".concat(Z,"-with-text").concat(v),w),(0,a.Z)(n,"".concat(Z,"-dashed"),!!j),(0,a.Z)(n,"".concat(Z,"-plain"),!!y),(0,a.Z)(n,"".concat(Z,"-rtl"),"rtl"===s),(0,a.Z)(n,"".concat(Z,"-no-default-orientation-margin-left"),D),(0,a.Z)(n,"".concat(Z,"-no-default-orientation-margin-right"),k),n),f),S=(0,r.Z)((0,r.Z)({},D&&{marginLeft:x}),k&&{marginRight:x});return o.createElement("div",(0,r.Z)({className:C},b,{role:"separator"}),g&&o.createElement("span",{className:"".concat(Z,"-inner-text"),style:S},g))}))}}}]);
//# sourceMappingURL=326.dfa391c5.chunk.js.map