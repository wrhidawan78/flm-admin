"use strict";(self.webpackChunkbmg_web_app=self.webpackChunkbmg_web_app||[]).push([[677],{7562:function(e,t,n){var r=n(1413),a=n(2791),i=n(6871),o=n(374),l=n(184);t.Z=function(e,t){return function(n){var s=(0,a.useContext)(o.V),c=(0,i.s0)(),u=s.userToken;return(0,a.useEffect)((function(){"undefined"!==typeof window&&(u?-1===(null===t||void 0===t?void 0:t.indexOf(s.userRole))&&c("/403",{replace:!0}):c("/auth",{replace:!0}))}),[u,s.userRole,c]),"undefined"!==typeof window?s.isLoading?(console.log("loading from with auth"),null):(0,l.jsx)(e,(0,r.Z)({},n)):null}}},677:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(9439),a=n(2791),i=n(6871),o=n(8735),l=n(8164),s=n(6106),c=n(3099),u=n(7309),d=n(7496),p=n(5696),m=n(7562),f=n(2567),g=n(3853),h=n(4971),x=n(6208),v=n(5095),w=n.n(v),Z=n(5303),y=n(3695),j=n(4980),b=n(1333),C=n(2393),S=n(184),P=Z.Z.Option,k=function(e){var t=e.visible,n=e.onCancel,i=e.setUpdateData,o=e.state,l=e.updating,s=(0,x.KQ)("employee"),c=s.data,p=s.loading,m=(0,x.KQ)("users/role"),h=m.data,v=m.loading,w=(0,a.useState)(""),Z=(0,r.Z)(w,2),k=Z[0],I=Z[1],_=(0,a.useState)(""),O=(0,r.Z)(_,2),z=O[0],E=O[1],D=(0,a.useState)(""),L=(0,r.Z)(D,2),R=L[0],U=L[1],F=(0,a.useState)(""),M=(0,r.Z)(F,2),q=M[0],N=M[1],T=(0,a.useState)(""),K=(0,r.Z)(T,2),B=K[0],A=K[1],G=(0,a.useState)(""),Y=(0,r.Z)(G,2),$=Y[0],Q=Y[1],J=function(){I(""),E(""),U(""),N(""),A(""),Q(""),W.resetFields()},V=d.Z.useForm(),W=(0,r.Z)(V,1)[0],X=(0,a.useMemo)((function(){return c}),[c]),H=(0,a.useMemo)((function(){return h}),[h]),ee=(0,a.useState)({url:"",data:{},trigger:0}),te=(0,r.Z)(ee,2),ne=te[0],re=te[1],ae=(0,a.useState)({url:"",data:{},trigger:0}),ie=(0,r.Z)(ae,2),oe=ie[0],le=ie[1],se=(0,x.u5)(ne.url,ne.data,ne.trigger),ce=se.onSuccess,ue=se.loading,de=(0,x.Fc)(oe.url,oe.data,oe.trigger),pe=de.onSuccess,me=de.loading;return(0,a.useEffect)((function(){ce.includes("success")&&(y.ZP.success("Berhasil Register ".concat(z)),J(),n(),i(Date.now())),pe.includes("success")&&(y.ZP.success("Berhasil Update User ".concat(z)),J(),n(),i(Date.now()))}),[ce,pe]),(0,a.useEffect)((function(){o.user_id&&l?(I(""),E(o.email),A(o.role_id),Q(""),W.setFieldsValue({empId:"",email:o.email,role:o.role_id,isActive:""})):J()}),[o,l]),(0,S.jsx)(j.Z,{title:l?"Update User":"Register User",visible:t,onCancel:n,footer:!1,children:(0,S.jsxs)(d.Z,{form:W,name:"createsite",autoComplete:"off",children:[(0,S.jsx)(f.ih,{name:"empId",label:"Employee",requiredLabel:!0,required:!0,message:"Please select employee!",placeholder:"select employee",allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:function(e){return I(e)},loading:p,disabled:p,children:X.map((function(e){return(0,S.jsx)(P,{value:e.id,children:"[".concat(e.id,"] ").concat(e.name)},e.id)}))}),(0,S.jsx)(f.yt,{label:"Email",requiredLabel:!0,name:"email",required:!0,message:"please input email!",placeholder:"input email",onChange:function(e){return(0,C.IY)(e,E)}}),(0,S.jsx)(f.$M,{label:"Password",requiredLabel:!0,name:"password",required:!0,message:"Please input your password!",placeholder:"enter your password",onChange:function(e){return(0,C.IY)(e,U)}}),(0,S.jsx)(f.$M,{label:"Confirm Password",requiredLabel:!0,name:"confirmPass",required:!0,message:"Please input your confirm password!",placeholder:"enter your confirm password",onChange:function(e){return(0,C.IY)(e,N)}}),(0,S.jsx)(f.ih,{name:"role",label:"Role",requiredLabel:!0,required:!0,message:"Please select role!",placeholder:"select role",allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:function(e){return A(e)},loading:v,disabled:v,children:H.map((function(e){return(0,S.jsx)(P,{value:e.id,children:"[".concat(e.id,"] ").concat(e.name)},e.id)}))}),(0,S.jsxs)(f.ih,{name:"isActive",label:"Status",requiredLabel:!0,required:!0,message:"Please select status!",placeholder:"select status",onChange:function(e){return Q(e)},children:[(0,S.jsx)(P,{value:1,children:"Active"}),(0,S.jsx)(P,{value:0,children:"Inactive"})]}),(0,S.jsx)(b.Z,{}),(0,S.jsx)(f.Wy,{children:(0,S.jsx)(d.Z.Item,{children:l?(0,S.jsx)(u.Z,{type:"primary",shape:"round",icon:(0,S.jsx)(g.t$,{style:{marginRight:"6px"}}),onClick:function(){if(!o.user_id||!k||!z||!R||!B||""===$)return y.ZP.warn("Form tidak boleh kosong"),null;if(R.length<8)return y.ZP.warn("Password panjang minimal 8 karakter"),null;if(q.length<8)return y.ZP.warn("Konfirmasi password panjang minimal 8 karakter"),null;if(R!==q)return y.ZP.warn("Konfirmasi password tidak sesuai"),null;var e={user_id:o.user_id,email:z,password:q,active:$,role_id:B,employe_id:k};console.log("data update: ",e),le({url:"users/edit",data:e,trigger:(new Date).getTime()})},loading:me,htmlType:"submit",children:"Update User"}):(0,S.jsx)(u.Z,{type:"primary",shape:"round",icon:(0,S.jsx)(g.t$,{style:{marginRight:"6px"}}),onClick:function(){if(!k||!z||!R||!B||""===$)return y.ZP.warn("Form tidak boleh kosong"),null;if(R.length<8)return y.ZP.warn("Password panjang minimal 8 karakter"),null;if(q.length<8)return y.ZP.warn("Konfirmasi password panjang minimal 8 karakter"),null;if(R!==q)return y.ZP.warn("Konfirmasi password tidak sesuai"),null;var e={employe_id:k,email:z,password:q,role_id:B,is_active:$};console.log("data post: ",e),re({url:"auth/signup",data:e,trigger:(new Date).getTime()})},loading:ue,htmlType:"submit",children:"Register User"})})})]})})},I=o.Z.Title,_=o.Z.Text,O=(0,m.Z)((function(){var e=(0,a.useState)(0),t=(0,r.Z)(e,2),n=t[0],o=t[1],m=(0,a.useState)(1),v=(0,r.Z)(m,2),Z=v[0],y=v[1],j=(0,a.useState)(20),b=(0,r.Z)(j,2),C=b[0],P=b[1],O=(0,x.cF)("users?page=".concat(Z,"&perpage=").concat(C),n),z=O.data,E=O.pagination,D=O.loading,L=(0,a.useState)(""),R=(0,r.Z)(L,2),U=R[0],F=R[1],M=(0,a.useState)({}),q=(0,r.Z)(M,2),N=q[0],T=q[1],K=(0,a.useState)(!1),B=(0,r.Z)(K,2),A=B[0],G=B[1],Y=(0,a.useMemo)((function(){return 0===z.length?[]:z.filter((function(e){var t;return null===(t=e.emp_name)||void 0===t?void 0:t.toLowerCase().includes(null===U||void 0===U?void 0:U.toLowerCase())}))}),[z,U]),$=(0,x.qY)(),Q=$.isOpen,J=$.onOpen,V=$.onClose,W=(0,i.s0)(),X=(0,a.useRef)(w()((function(e){return F(e)}),1e3)).current,H=function(e){G(!0),T(e),J()},ee=[{title:"#",dataIndex:"user_id",render:function(e,t){return(0,S.jsx)(_,{strong:!0,style:{cursor:"pointer"},onClick:function(){return H(t)},children:e})},width:70,fixed:"left"},{title:"Name",dataIndex:"emp_name",render:function(e,t){return(0,S.jsx)(_,{strong:!0,style:{cursor:"pointer"},onClick:function(){return H(t)},children:e})},fixed:"left"},{title:"Email",dataIndex:"email",width:200},{title:"DOB",dataIndex:"emp_birth_date"},{title:"Division",dataIndex:"division_name"},{title:"Phone",dataIndex:"mobile_phone"},{title:"Gender",dataIndex:"gender"},{title:"Status",dataIndex:"status"},{title:"Address",dataIndex:"address",ellipsis:!0},{title:"Join Date",dataIndex:"join_date"},{title:"Resign Date",dataIndex:"resign_date"},{title:"Supervisor",dataIndex:"supervisor"},{title:"Role",dataIndex:"role_name"}];return(0,S.jsxs)("div",{children:[(0,S.jsx)(l.Z,{style:{margin:"16px 0"},children:(0,S.jsx)(l.Z.Item,{children:"User Management"})}),(0,S.jsx)(k,{visible:Q,onCancel:V,setUpdateData:o,state:N,updating:A}),(0,S.jsx)("div",{children:(0,S.jsxs)(f.Zb,{children:[(0,S.jsx)(I,{level:3,type:"secondary",style:{marginRight:20,marginBottom:30},children:"User List"}),(0,S.jsxs)(s.Z,{gutter:[16,10],children:[(0,S.jsx)(f.lr,{children:(0,S.jsxs)(c.Z,{wrap:!0,children:[(0,S.jsx)(u.Z,{shape:"round",icon:(0,S.jsx)(g.xVi,{style:{marginRight:6}}),onClick:function(){G(!1),J()},children:"Register User"}),(0,S.jsx)(f.hU,{icon:(0,S.jsx)(g.Yjd,{size:20}),toolTip:"Upload data user",onClick:function(){return W("/user-management/upload")}}),(0,S.jsx)("a",{href:"/uploaduser.csv",target:"_blank",rel:"noreferrer",children:(0,S.jsx)(f.hU,{icon:(0,S.jsx)(g._hL,{color:h.zP,size:20}),style:{backgroundColor:h.RJ},toolTip:"Download template user"})})]})}),(0,S.jsx)(f.r$,{children:(0,S.jsx)(d.Z,{name:"searchUser",autoComplete:"off",children:(0,S.jsx)(f.yt,{name:"search",prefix:(0,S.jsx)(g.jRj,{color:h.wm}),allowClear:!0,placeholder:"serach user",value:U,onChange:function(e){return X(e.target.value)}})})})]}),(0,S.jsx)("div",{style:{marginTop:"20px"},children:(0,S.jsx)(p.Z,{columns:ee,dataSource:Y,rowKey:function(e){return e.user_id},loading:D,scroll:{y:500,x:1800},pagination:{total:E.total_data,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showQuickJumper:!0,defaultCurrent:1,onChange:function(e){return y(e)},showSizeChanger:!0,onShowSizeChange:function(e,t){return P(t)},defaultPageSize:C,pageSizeOptions:[20,60,100,140]}})})]})})]})}),[1])},2393:function(e,t,n){n.d(t,{QD:function(){return a},cX:function(){return i},IY:function(){return o},U6:function(){return l}});n(2426);var r=n(5095),a=function(e){return new Intl.NumberFormat("id-ID").format(e)},i=function(e){return new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})},o=n.n(r)()((function(e,t){return t(e.target.value)}),500),l=function(e){return"number"===typeof e?e>=1e6?"".concat((e/1e6).toFixed(2)," MM"):e>=1e3?"".concat((e/1e3).toFixed(2)," KM"):"".concat(e," Meter"):e}},1333:function(e,t,n){var r=n(7462),a=n(4942),i=n(2791),o=n(1694),l=n.n(o),s=n(9077),c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};t.Z=function(e){return i.createElement(s.C,null,(function(t){var n,o=t.getPrefixCls,s=t.direction,u=e.prefixCls,d=e.type,p=void 0===d?"horizontal":d,m=e.orientation,f=void 0===m?"center":m,g=e.orientationMargin,h=e.className,x=e.children,v=e.dashed,w=e.plain,Z=c(e,["prefixCls","type","orientation","orientationMargin","className","children","dashed","plain"]),y=o("divider",u),j=f.length>0?"-".concat(f):f,b=!!x,C="left"===f&&null!=g,S="right"===f&&null!=g,P=l()(y,"".concat(y,"-").concat(p),(n={},(0,a.Z)(n,"".concat(y,"-with-text"),b),(0,a.Z)(n,"".concat(y,"-with-text").concat(j),b),(0,a.Z)(n,"".concat(y,"-dashed"),!!v),(0,a.Z)(n,"".concat(y,"-plain"),!!w),(0,a.Z)(n,"".concat(y,"-rtl"),"rtl"===s),(0,a.Z)(n,"".concat(y,"-no-default-orientation-margin-left"),C),(0,a.Z)(n,"".concat(y,"-no-default-orientation-margin-right"),S),n),h),k=(0,r.Z)((0,r.Z)({},C&&{marginLeft:g}),S&&{marginRight:g});return i.createElement("div",(0,r.Z)({className:P},Z,{role:"separator"}),x&&i.createElement("span",{className:"".concat(y,"-inner-text"),style:k},x))}))}},6106:function(e,t,n){var r=n(7545);t.Z=r.Z},3099:function(e,t,n){n.d(t,{u:function(){return f},Z:function(){return h}});var r=n(7462),a=n(4942),i=n(9439),o=n(2791),l=n(1694),s=n.n(l),c=n(5501),u=n(9077);function d(e){var t=e.className,n=e.direction,i=e.index,l=e.marginDirection,s=e.children,c=e.split,u=e.wrap,d=o.useContext(f),p=d.horizontalSize,m=d.verticalSize,g=d.latestIndex,h={};return d.supportFlexGap||("vertical"===n?i<g&&(h={marginBottom:p/(c?2:1)}):h=(0,r.Z)((0,r.Z)({},i<g&&(0,a.Z)({},l,p/(c?2:1))),u&&{paddingBottom:m})),null===s||void 0===s?null:o.createElement(o.Fragment,null,o.createElement("div",{className:t,style:h},s),i<g&&c&&o.createElement("span",{className:"".concat(t,"-split"),style:h},c))}var p=n(9911),m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},f=o.createContext({latestIndex:0,horizontalSize:0,verticalSize:0,supportFlexGap:!1}),g={small:8,middle:16,large:24};var h=function(e){var t,n=o.useContext(u.E_),l=n.getPrefixCls,h=n.space,x=n.direction,v=e.size,w=void 0===v?(null===h||void 0===h?void 0:h.size)||"small":v,Z=e.align,y=e.className,j=e.children,b=e.direction,C=void 0===b?"horizontal":b,S=e.prefixCls,P=e.split,k=e.style,I=e.wrap,_=void 0!==I&&I,O=m(e,["size","align","className","children","direction","prefixCls","split","style","wrap"]),z=(0,p.Z)(),E=o.useMemo((function(){return(Array.isArray(w)?w:[w,w]).map((function(e){return function(e){return"string"===typeof e?g[e]:e||0}(e)}))}),[w]),D=(0,i.Z)(E,2),L=D[0],R=D[1],U=(0,c.Z)(j,{keepEmpty:!0}),F=void 0===Z&&"horizontal"===C?"center":Z,M=l("space",S),q=s()(M,"".concat(M,"-").concat(C),(t={},(0,a.Z)(t,"".concat(M,"-rtl"),"rtl"===x),(0,a.Z)(t,"".concat(M,"-align-").concat(F),F),t),y),N="".concat(M,"-item"),T="rtl"===x?"marginLeft":"marginRight",K=0,B=U.map((function(e,t){return null!==e&&void 0!==e&&(K=t),o.createElement(d,{className:N,key:"".concat(N,"-").concat(t),direction:C,index:t,marginDirection:T,split:P,wrap:_},e)})),A=o.useMemo((function(){return{horizontalSize:L,verticalSize:R,latestIndex:K,supportFlexGap:z}}),[L,R,K,z]);if(0===U.length)return null;var G={};return _&&(G.flexWrap="wrap",z||(G.marginBottom=-R)),z&&(G.columnGap=L,G.rowGap=R),o.createElement("div",(0,r.Z)({className:q,style:(0,r.Z)((0,r.Z)({},G),k)},O),o.createElement(f.Provider,{value:A},B))}}}]);
//# sourceMappingURL=677.5a2f9a0e.chunk.js.map