"use strict";(self.webpackChunkbmg_web_app=self.webpackChunkbmg_web_app||[]).push([[759],{7562:function(e,t,n){var a=n(1413),i=n(2791),r=n(6871),l=n(374),s=n(184);t.Z=function(e,t){return function(n){var o=(0,i.useContext)(l.V),d=(0,r.s0)(),u=o.userToken;return(0,i.useEffect)((function(){"undefined"!==typeof window&&(u?-1===(null===t||void 0===t?void 0:t.indexOf(o.userRole))&&d("/403",{replace:!0}):d("/auth",{replace:!0}))}),[u,o.userRole,d]),"undefined"!==typeof window?o.isLoading?(console.log("loading from with auth"),null):(0,s.jsx)(e,(0,a.Z)({},n)):null}}},9759:function(e,t,n){n.r(t),n.d(t,{default:function(){return Q}});var a=n(9439),i=n(2791),r=n(6871),l=n(8735),s=n(7496),o=n(8164),d=n(6106),u=n(3099),c=n(7309),p=n(5696),m=n(7562),h=n(2567),g=n(3853),f=n(4971),x=n(2393),j=n(6208),b=n(5095),y=n.n(b),Z=n(3433),C=n(5303),S=n(3695),v=n(4980),w=n(1333),I=n(1995),q=n(1413),L=n(4925),_=n(9553),k=n(184),F=["label","name","validateStatus","hasFeedback","help","required","requiredLabel","message","beforeUpload","onRemove","fileList"],D=l.Z.Text,O=function(e){var t=e.label,n=e.name,a=e.validateStatus,i=e.hasFeedback,r=e.help,l=e.required,o=e.requiredLabel,d=e.message,u=e.beforeUpload,p=e.onRemove,m=e.fileList,h=(0,L.Z)(e,F);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(D,{type:"secondary",children:t}),o&&(0,k.jsx)(D,{type:"danger",children:"*"}),(0,k.jsx)(s.Z.Item,{name:n,validateStatus:a,hasFeedback:i,help:r,rules:[{required:l,message:d}],children:(0,k.jsx)(_.Z,(0,q.Z)((0,q.Z)({multiple:!1,name:"file",beforeUpload:u,onRemove:p,fileList:m},h),{},{children:(0,k.jsx)(c.Z,{icon:(0,k.jsx)(g.Yjd,{}),children:"Upload an image"})}))})]})},U=C.Z.Option,Y=function(e){var t=e.isOpen,n=e.onClose,r=e.setUpdateData,l=(0,j.KQ)("employee"),o=l.data,d=l.loading,u=(0,i.useState)(""),p=(0,a.Z)(u,2),m=p[0],f=p[1],b=(0,i.useState)(""),y=(0,a.Z)(b,2),C=y[0],q=y[1],L=(0,i.useState)(""),_=(0,a.Z)(L,2),F=_[0],D=_[1],Y=(0,i.useState)(""),T=(0,a.Z)(Y,2),E=T[0],R=T[1],P=(0,i.useState)(""),N=(0,a.Z)(P,2),z=N[0],M=N[1],B=(0,i.useState)([]),A=(0,a.Z)(B,2),K=A[0],Q=A[1],V=(0,i.useState)([]),W=(0,a.Z)(V,2),$=W[0],J=W[1],X=s.Z.useForm(),G=(0,a.Z)(X,1)[0],H=(0,i.useMemo)((function(){return o}),[o]),ee=(0,i.useState)({url:"",data:{},trigger:0}),te=(0,a.Z)(ee,2),ne=te[0],ae=te[1],ie=(0,j.tm)(ne.url,ne.data,ne.trigger),re=ie.onSuccess,le=ie.loading;return(0,i.useEffect)((function(){re.includes("success")&&(S.ZP.success("Berhasil Create Site ".concat(m)),f(""),q(""),D(""),R(""),M(""),Q([]),J([]),G.resetFields(),n(),r(Date.now()))}),[re]),(0,k.jsx)(v.Z,{title:"Create Site",visible:t,onCancel:n,footer:!1,width:1e3,children:(0,k.jsxs)(s.Z,{form:G,name:"createsite",autoComplete:"off",children:[(0,k.jsxs)(h.Ej,{children:[(0,k.jsxs)(h.b0,{children:[(0,k.jsx)(h.yt,{label:"Site Id",requiredLabel:!0,name:"siteId",required:!0,message:"please input site id!",placeholder:"input site id",onChange:function(e){return(0,x.IY)(e,f)}}),(0,k.jsx)(h.yt,{label:"Site Name",requiredLabel:!0,name:"siteName",required:!0,message:"please input site name!",placeholder:"input site name",onChange:function(e){return(0,x.IY)(e,q)}}),(0,k.jsx)(O,{label:"Site Image",requiredLabel:!0,name:"siteImage",required:!0,message:"please upload site image!",fileList:K,beforeUpload:function(e){return Q([].concat((0,Z.Z)(K),[e])),!1},onRemove:function(e){return Q((function(t){return t.filter((function(t){return t.uid!==e.uid}))}))}}),(0,k.jsx)(I.ih,{name:"employee",label:"Employee",requiredLabel:!0,required:!0,message:"Please select employee!",placeholder:"select employee",mode:"multiple",allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:function(e){return J(e)},loading:d,disabled:d,children:H.map((function(e){return(0,k.jsx)(U,{value:e.id,children:"[".concat(e.id,"] ").concat(e.name)},e.id)}))})]}),(0,k.jsxs)(h.b0,{children:[(0,k.jsx)(h.yt,{label:"Latitude",requiredLabel:!0,name:"lat",help:"Contoh: -6.1668048",required:!0,message:"please input latitude!",placeholder:"input latitude",onChange:function(e){return(0,x.IY)(e,D)},type:"number"}),(0,k.jsx)(h.yt,{label:"Longitude",requiredLabel:!0,name:"lng",help:"Contoh: 106.9153422",required:!0,message:"please input longitude!",placeholder:"input longitude",onChange:function(e){return(0,x.IY)(e,R)},type:"number"}),(0,k.jsx)(I.ld,{label:"Address",requiredLabel:!0,name:"address",required:!0,message:"please input address!",rows:4,placeholder:"input address",onChange:function(e){return(0,x.IY)(e,M)}})]})]}),(0,k.jsx)(w.Z,{}),(0,k.jsx)(h.Wy,{children:(0,k.jsx)(s.Z.Item,{children:(0,k.jsx)(c.Z,{type:"primary",shape:"round",icon:(0,k.jsx)(g.t$,{style:{marginRight:"6px"}}),onClick:function(){if(!m||!C||0===K.length||0===$.length||!F||!E||!z)return S.ZP.warn("Form tidak boleh kosong"),null;var e=new FormData;e.append("site_id",m),e.append("name",C),e.append("latitude",F),e.append("longitude",E),e.append("address",z),e.append("photo",K[0]),e.append("employe_id",$.join()),console.log("data post: ",e),ae({url:"site/create",data:e,trigger:(new Date).getTime()})},loading:le,htmlType:"submit",children:"Create Site"})})})]})})},T=n(8361),E=l.Z.Title,R=l.Z.Text,P=function(e){var t=e.label,n=e.children;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(R,{type:"secondary",children:t}),(0,k.jsx)(E,{level:5,style:{marginTop:"0px",marginBottom:"14px"},children:n})]})},N=function(e){var t=e.label,n=e.children;return(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,k.jsx)(R,{type:"secondary",children:t}),(0,k.jsx)(R,{type:"secondary",style:{marginTop:"0px",marginBottom:"14px"},children:n})]})},z=function(e){var t=e.title,n=e.visible,r=e.onCancel,l=e.onEdit,s=e.state,o=(0,i.useState)(""),d=(0,a.Z)(o,2),u=d[0],p=d[1],m=(0,j.KQ)(u),f=m.data,x=m.loading,b=(0,i.useMemo)((function(){return 0===f.length?{id:"",site_id:"",name:"",long:"",lat:"",metadata:"",address:"",status:"",created_at:"",created_by:"",approved_at:"",approved_by:"",deleted_at:"",deleted_by:"",image_attachment:"",full_path:"",employe_name:"",site_employe_id:""}:f[0]}),[f]);return(0,i.useEffect)((function(){s.id&&p("site/show?id=".concat(s.id))}),[s]),(0,k.jsx)(v.Z,{title:t,visible:n,onCancel:r,footer:!1,width:1e3,children:(0,k.jsxs)(T.Z,{loading:x,active:!0,children:[(0,k.jsx)(h.Wy,{style:{marginBottom:-30},children:(0,k.jsx)(c.Z,{shape:"round",onClick:l,icon:(0,k.jsx)(g.IYd,{style:{marginRight:6}}),children:"Edit"})}),(0,k.jsxs)(h.Ej,{children:[(0,k.jsxs)(h.b0,{children:[(0,k.jsx)(P,{label:"Site ID",children:b.site_id}),(0,k.jsx)(P,{label:"Site name",children:b.name}),(0,k.jsx)(P,{label:"Latitude",children:b.lat}),(0,k.jsx)(P,{label:"Longitude",children:b.long}),(0,k.jsx)(N,{label:"Address",children:b.address})]}),(0,k.jsxs)(h.b0,{children:[(0,k.jsx)(P,{label:"Employee",children:b.employe_name}),(0,k.jsx)(P,{label:"Status",children:b.status}),(0,k.jsx)(P,{label:"Image",children:b.image_attachment}),(0,k.jsx)(P,{label:"Created at",children:b.created_at})]})]})]})})},M=C.Z.Option,B=function(e){var t=e.isOpen,n=e.onClose,r=e.setUpdateData,l=e.data,o=(0,j.KQ)("employee"),d=o.data,u=o.loading,p=(0,i.useState)(""),m=(0,a.Z)(p,2),f=m[0],b=m[1],y=(0,i.useState)(""),C=(0,a.Z)(y,2),q=C[0],L=C[1],_=(0,i.useState)(""),F=(0,a.Z)(_,2),D=F[0],U=F[1],Y=(0,i.useState)(""),T=(0,a.Z)(Y,2),E=T[0],R=T[1],P=(0,i.useState)(""),N=(0,a.Z)(P,2),z=N[0],B=N[1],A=(0,i.useState)([]),K=(0,a.Z)(A,2),Q=K[0],V=K[1],W=(0,i.useState)([]),$=(0,a.Z)(W,2),J=$[0],X=$[1],G=(0,i.useState)(""),H=(0,a.Z)(G,2),ee=H[0],te=H[1],ne=s.Z.useForm(),ae=(0,a.Z)(ne,1)[0],ie=(0,i.useMemo)((function(){return d}),[d]),re=(0,i.useState)({url:"",data:{},trigger:0}),le=(0,a.Z)(re,2),se=le[0],oe=le[1],de=(0,j.tm)(se.url,se.data,se.trigger),ue=de.onSuccess,ce=de.loading;return(0,i.useEffect)((function(){ue.includes("success")&&(S.ZP.success("Berhasil Update Site ".concat(f)),b(""),L(""),U(""),R(""),B(""),V([]),X([]),te(""),ae.resetFields(),n(),r(Date.now()))}),[ue]),(0,i.useEffect)((function(){l.id&&(b(l.site_id),L(l.name),U(l.lat),R(l.long),B(l.address),te(l.status),ae.setFieldsValue({siteId:l.site_id,siteName:l.name,lat:l.lat,lng:l.long,address:l.address,status:l.status}))}),[l,ae]),(0,k.jsx)(v.Z,{title:"Update Site ".concat(l.site_id),visible:t,onCancel:n,footer:!1,width:1e3,children:(0,k.jsxs)(s.Z,{form:ae,name:"createsite",autoComplete:"off",children:[(0,k.jsxs)(h.Ej,{children:[(0,k.jsxs)(h.b0,{children:[(0,k.jsx)(h.yt,{label:"Site Id",requiredLabel:!0,name:"siteId",required:!0,message:"please input site id!",placeholder:"input site id",onChange:function(e){return(0,x.IY)(e,b)},disabled:!0}),(0,k.jsx)(h.yt,{label:"Site Name",requiredLabel:!0,name:"siteName",required:!0,message:"please input site name!",placeholder:"input site name",onChange:function(e){return(0,x.IY)(e,L)}}),(0,k.jsx)(O,{label:"Site Image",requiredLabel:!0,name:"siteImage",required:!0,message:"please upload site image!",fileList:Q,beforeUpload:function(e){return V([].concat((0,Z.Z)(Q),[e])),!1},onRemove:function(e){return V((function(t){return t.filter((function(t){return t.uid!==e.uid}))}))}}),(0,k.jsx)(I.ih,{name:"employee",label:"Employee",requiredLabel:!0,required:!0,message:"Please select employee!",placeholder:"select employee",mode:"multiple",allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:function(e){return X(e)},loading:u,disabled:u,children:ie.map((function(e){return(0,k.jsx)(M,{value:e.id,children:"[".concat(e.id,"] ").concat(e.name)},e.id)}))}),(0,k.jsxs)(I.ih,{name:"status",label:"Status",requiredLabel:!0,required:!0,message:"Please select status!",placeholder:"select status",onChange:function(e){return te(e)},children:[(0,k.jsx)(M,{value:0,children:"Inactive"}),(0,k.jsx)(M,{value:1,children:"Active"})]})]}),(0,k.jsxs)(h.b0,{children:[(0,k.jsx)(h.yt,{label:"Latitude",requiredLabel:!0,name:"lat",help:"Contoh: -6.1668048",required:!0,message:"please input latitude!",placeholder:"input latitude",onChange:function(e){return(0,x.IY)(e,U)},type:"number"}),(0,k.jsx)(h.yt,{label:"Longitude",requiredLabel:!0,name:"lng",help:"Contoh: 106.9153422",required:!0,message:"please input longitude!",placeholder:"input longitude",onChange:function(e){return(0,x.IY)(e,R)},type:"number"}),(0,k.jsx)(I.ld,{label:"Address",requiredLabel:!0,name:"address",required:!0,message:"please input address!",rows:4,placeholder:"input address",onChange:function(e){return(0,x.IY)(e,B)}})]})]}),(0,k.jsx)(w.Z,{}),(0,k.jsx)(h.Wy,{children:(0,k.jsx)(s.Z.Item,{children:(0,k.jsx)(c.Z,{type:"primary",shape:"round",icon:(0,k.jsx)(g.t$,{style:{marginRight:"6px"}}),onClick:function(){if(!l.id||!f||!q||0===Q.length||0===J.length||!D||!E||!z||!ee)return S.ZP.warn("Form tidak boleh kosong"),null;var e=new FormData;e.append("site_id",f),e.append("name",q),e.append("latitude",D),e.append("longitude",E),e.append("address",z),e.append("photo",Q[0]),e.append("employe_id",J.join()),e.append("status",ee),console.log("data post: ",e),oe({url:"site/edit?id=".concat(l.id),data:e,trigger:(new Date).getTime()})},loading:ce,htmlType:"submit",children:"Update Site"})})})]})})},A=l.Z.Title,K=l.Z.Text,Q=(0,m.Z)((function(){var e=(0,i.useState)(0),t=(0,a.Z)(e,2),n=t[0],l=t[1],m=(0,i.useState)(1),b=(0,a.Z)(m,2),Z=b[0],C=b[1],S=(0,i.useState)(20),v=(0,a.Z)(S,2),w=v[0],I=v[1],q=(0,i.useState)(""),L=(0,a.Z)(q,2),_=L[0],F=L[1],D=(0,j.cF)("site?name=".concat(_,"&page=").concat(Z,"&perpage=").concat(w),n),O=D.data,U=D.pagination,T=D.loading,E=(0,i.useState)({}),R=(0,a.Z)(E,2),P=R[0],N=R[1],M=(0,r.s0)(),Q=s.Z.useForm(),V=(0,a.Z)(Q,1)[0],W=(0,j.qY)(),$=W.isOpen,J=W.onOpen,X=W.onClose,G=(0,j.qY)(),H=G.isOpen,ee=G.onOpen,te=G.onClose,ne=(0,j.qY)(),ae=ne.isOpen,ie=ne.onOpen,re=ne.onClose,le=(0,i.useRef)(y()((function(e){return F(e)}),1e3)).current,se=function(e){N(e),ie()};(0,i.useEffect)((function(){$||(F(""),V.resetFields())}),[$,V]);var oe=[{title:"#",dataIndex:"id",render:function(e,t){return(0,k.jsx)(K,{strong:!0,style:{cursor:"pointer"},onClick:function(){return se(t)},children:e})},width:70},{title:"Site ID",dataIndex:"site_id",render:function(e,t){return(0,k.jsx)(K,{strong:!0,style:{cursor:"pointer"},onClick:function(){return se(t)},children:e})}},{title:"Site Name",dataIndex:"name"},{title:"Latitude",dataIndex:"lat"},{title:"Longitude",dataIndex:"long"},{title:"Address",dataIndex:"address",ellipsis:!0},{title:"Created",dataIndex:"created_at",render:function(e){return(0,x.cX)(e)}}];return(0,k.jsxs)("div",{children:[(0,k.jsx)(o.Z,{style:{margin:"16px 0"},children:(0,k.jsx)(o.Z.Item,{children:"Site"})}),(0,k.jsx)(Y,{isOpen:$,onClose:X,setUpdateData:l}),(0,k.jsx)(B,{isOpen:H,onClose:te,setUpdateData:l,data:P}),(0,k.jsx)(z,{title:"Details Site ".concat(P.site_id),visible:ae,onCancel:re,onEdit:function(){re(),ee()},state:P}),(0,k.jsx)("div",{children:(0,k.jsxs)(h.Zb,{children:[(0,k.jsx)(A,{level:3,type:"secondary",style:{marginRight:20,marginBottom:30},children:"Site List"}),(0,k.jsxs)(d.Z,{gutter:[16,10],children:[(0,k.jsx)(h.lr,{children:(0,k.jsxs)(u.Z,{wrap:!0,children:[(0,k.jsx)(c.Z,{shape:"round",icon:(0,k.jsx)(g.xVi,{style:{marginRight:6}}),onClick:J,children:"New Site"}),(0,k.jsx)(h.hU,{icon:(0,k.jsx)(g.Yjd,{size:20}),toolTip:"Upload data site",onClick:function(){return M("/site/upload-site")}}),(0,k.jsx)("a",{href:"/uploadmultiplesite.csv",target:"_blank",rel:"noreferrer",children:(0,k.jsx)(h.hU,{icon:(0,k.jsx)(g._hL,{color:f.zP,size:20}),style:{backgroundColor:f.RJ},toolTip:"Download template site"})})]})}),(0,k.jsx)(h.r$,{children:(0,k.jsx)(s.Z,{form:V,name:"searchSite",autoComplete:"off",children:(0,k.jsx)(h.yt,{name:"search",prefix:(0,k.jsx)(g.jRj,{color:f.wm}),allowClear:!0,placeholder:"serach site",value:_,onChange:function(e){return le(e.target.value)}})})})]}),(0,k.jsx)("div",{style:{marginTop:"20px"},children:(0,k.jsx)(p.Z,{columns:oe,dataSource:O,rowKey:function(e){return e.id},loading:T,scroll:{y:500},pagination:{total:U.total_data,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showQuickJumper:!0,defaultCurrent:1,onChange:function(e){return C(e)},showSizeChanger:!0,onShowSizeChange:function(e,t){return I(t)},defaultPageSize:w,pageSizeOptions:[20,60,100,140]}})})]})})]})}))},2393:function(e,t,n){n.d(t,{QD:function(){return i},cX:function(){return r},IY:function(){return l},U6:function(){return s}});n(2426);var a=n(5095),i=function(e){return new Intl.NumberFormat("id-ID").format(e)},r=function(e){return new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})},l=n.n(a)()((function(e,t){return t(e.target.value)}),500),s=function(e){return"number"===typeof e?e>=1e6?"".concat((e/1e6).toFixed(2)," MM"):e>=1e3?"".concat((e/1e3).toFixed(2)," KM"):"".concat(e," Meter"):e}}}]);
//# sourceMappingURL=759.114b8317.chunk.js.map